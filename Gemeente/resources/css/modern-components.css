/**
 * ============================================================================
 * GEMEENTE PORTAL - MODERN COMPONENTS
 * Reusable component library met 2025 best practices
 * ============================================================================
 *
 * Features:
 * - Low-specificity selectors (:where) voor makkelijke overrides
 * - Alle states: hover, active, focus-visible, disabled
 * - Dark mode compatible
 * - Accessibility built-in (focus states, ARIA support)
 * - Container query support waar nodig
 */

@layer components {

  /* ==========================================================================
     BUTTONS - Complete button system
     ========================================================================== */

  /* Base button - gedeelde eigenschappen */
  :where(.btn) {
    /* Layout */
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);

    /* Typography */
    font-family: var(--font-sans);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    line-height: var(--line-height-tight);
    text-decoration: none;
    white-space: nowrap;

    /* Spacing */
    padding-block: var(--space-2-5);
    padding-inline: var(--space-4);

    /* Borders */
    border: 1px solid transparent;
    border-radius: var(--radius-md);

    /* Transitions */
    transition-property: background-color, border-color, color, box-shadow, transform;
    transition-duration: var(--duration-base);
    transition-timing-function: var(--ease-out);

    /* Interactivity */
    cursor: pointer;
    user-select: none;

    /* Defaults om inheritance te voorkomen */
    background-color: transparent;
    color: inherit;
  }

  /* Focus state - WCAG 2.1 compliant */
  :where(.btn):focus-visible {
    outline: 2px solid var(--color-border-focus);
    outline-offset: 2px;
  }

  /* Disabled state */
  :where(.btn):disabled,
  :where(.btn[aria-disabled="true"]) {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }

  /* Button variants */

  /* Primary - Hoofdactie */
  :where(.btn-primary) {
    background-color: var(--color-brand-primary);
    color: var(--color-brand-contrast);
    box-shadow: var(--shadow-sm);
  }

  :where(.btn-primary):hover:not(:disabled) {
    background-color: var(--color-brand-hover);
    box-shadow: var(--shadow-md);
    transform: translateY(-1px);
  }

  :where(.btn-primary):active:not(:disabled) {
    background-color: var(--color-brand-active);
    box-shadow: var(--shadow-sm);
    transform: translateY(0);
  }

  /* Secondary - Alternatieve actie */
  :where(.btn-secondary) {
    background-color: var(--color-bg-tertiary);
    color: var(--color-fg-primary);
    border-color: var(--color-border-primary);
  }

  :where(.btn-secondary):hover:not(:disabled) {
    background-color: var(--color-bg-secondary);
    border-color: var(--color-brand-primary);
    box-shadow: var(--shadow-sm);
  }

  :where(.btn-secondary):active:not(:disabled) {
    background-color: var(--color-bg-primary);
  }

  /* Outline - Tertiary actie */
  :where(.btn-outline) {
    background-color: transparent;
    color: var(--color-brand-primary);
    border-color: var(--color-brand-primary);
  }

  :where(.btn-outline):hover:not(:disabled) {
    background-color: var(--color-brand-lighter);
    border-color: var(--color-brand-hover);
    color: var(--color-brand-hover);
  }

  :where(.btn-outline):active:not(:disabled) {
    background-color: var(--color-brand-light);
  }

  /* Ghost - Minimale stijl */
  :where(.btn-ghost) {
    background-color: transparent;
    color: var(--color-fg-primary);
  }

  :where(.btn-ghost):hover:not(:disabled) {
    background-color: var(--color-bg-tertiary);
  }

  :where(.btn-ghost):active:not(:disabled) {
    background-color: var(--color-bg-secondary);
  }

  /* Semantic variants */
  :where(.btn-success) {
    background-color: var(--color-success);
    color: var(--color-success-contrast);
  }

  :where(.btn-success):hover:not(:disabled) {
    filter: brightness(1.1);
    box-shadow: var(--shadow-md);
  }

  :where(.btn-warning) {
    background-color: var(--color-warning);
    color: var(--color-warning-contrast);
  }

  :where(.btn-warning):hover:not(:disabled) {
    filter: brightness(1.1);
    box-shadow: var(--shadow-md);
  }

  :where(.btn-error) {
    background-color: var(--color-error);
    color: var(--color-error-contrast);
  }

  :where(.btn-error):hover:not(:disabled) {
    filter: brightness(1.1);
    box-shadow: var(--shadow-md);
  }

  /* Size variants */
  :where(.btn-sm) {
    font-size: var(--font-size-sm);
    padding-block: var(--space-1-5);
    padding-inline: var(--space-3);
  }

  :where(.btn-lg) {
    font-size: var(--font-size-lg);
    padding-block: var(--space-3-5);
    padding-inline: var(--space-6);
  }

  :where(.btn-xl) {
    font-size: var(--font-size-xl);
    padding-block: var(--space-4);
    padding-inline: var(--space-8);
    border-radius: var(--radius-lg);
  }

  /* Full width variant */
  :where(.btn-block) {
    width: 100%;
  }

  /* Icon only button */
  :where(.btn-icon) {
    padding: var(--space-2);
    aspect-ratio: 1;
  }

  /* ==========================================================================
     CARDS - Content containers
     ========================================================================== */

  :where(.card) {
    /* Container setup */
    container-type: inline-size;
    container-name: card;

    /* Layout */
    display: flex;
    flex-direction: column;

    /* Styling */
    background-color: var(--color-bg-primary);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);

    /* Transition */
    transition: box-shadow var(--duration-base) var(--ease-out),
                transform var(--duration-base) var(--ease-out);
  }

  /* Interactive card */
  :where(.card-interactive) {
    cursor: pointer;
  }

  :where(.card-interactive):hover {
    box-shadow: var(--shadow-lg);
    transform: translateY(-2px);
  }

  :where(.card-interactive):active {
    transform: translateY(0);
    box-shadow: var(--shadow-md);
  }

  /* Card sections */
  :where(.card-header) {
    padding: var(--space-6);
    border-bottom: 1px solid var(--color-border-secondary);
  }

  :where(.card-body) {
    padding: var(--space-6);
    flex: 1;
  }

  :where(.card-footer) {
    padding: var(--space-6);
    border-top: 1px solid var(--color-border-secondary);
    background-color: var(--color-bg-secondary);
    border-radius: 0 0 var(--radius-lg) var(--radius-lg);
  }

  /* Card with gradient (zoals in complaint form) */
  :where(.card-gradient) {
    background: linear-gradient(
      to bottom right,
      var(--color-brand-lighter),
      var(--color-bg-primary)
    );
    border: 1px solid var(--color-brand-light);
  }

  /* Compact card voor smaller containers */
  @container card (max-width: 400px) {
    :where(.card-header),
    :where(.card-body),
    :where(.card-footer) {
      padding: var(--space-4);
    }
  }

  /* ==========================================================================
     FORMS - Input elements
     ========================================================================== */

  /* Form group - wrapper voor label + input */
  :where(.form-group) {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  /* Labels */
  :where(.form-label) {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-fg-primary);
  }

  :where(.form-label-required)::after {
    content: " *";
    color: var(--color-error);
  }

  /* Base input styling */
  :where(.form-input),
  :where(.form-select),
  :where(.form-textarea) {
    /* Typography */
    font-family: var(--font-sans);
    font-size: var(--font-size-base);
    line-height: var(--line-height-normal);
    color: var(--color-fg-primary);

    /* Layout */
    width: 100%;
    padding: var(--space-3) var(--space-4);

    /* Borders */
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-md);

    /* Background */
    background-color: var(--color-bg-primary);

    /* Shadow */
    box-shadow: var(--shadow-sm);

    /* Transitions */
    transition: border-color var(--duration-base) var(--ease-out),
                box-shadow var(--duration-base) var(--ease-out);
  }

  /* Hover state */
  :where(.form-input):hover:not(:disabled),
  :where(.form-select):hover:not(:disabled),
  :where(.form-textarea):hover:not(:disabled) {
    border-color: var(--color-border-focus);
    box-shadow: var(--shadow-md);
  }

  /* Focus state */
  :where(.form-input):focus,
  :where(.form-select):focus,
  :where(.form-textarea):focus {
    outline: none;
    border-color: var(--color-brand-primary);
    box-shadow: 0 0 0 3px var(--color-brand-lighter);
  }

  /* Disabled state */
  :where(.form-input):disabled,
  :where(.form-select):disabled,
  :where(.form-textarea):disabled {
    opacity: 0.6;
    cursor: not-allowed;
    background-color: var(--color-bg-tertiary);
  }

  /* Textarea specifiek */
  :where(.form-textarea) {
    min-height: 120px;
    resize: vertical;
  }

  /* Select specifiek */
  :where(.form-select) {
    cursor: pointer;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E");
    background-position: right var(--space-3) center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: var(--space-10);
  }

  /* Error state */
  :where(.form-input-error),
  :where(.form-select-error),
  :where(.form-textarea-error) {
    border-color: var(--color-error);
  }

  :where(.form-input-error):focus,
  :where(.form-select-error):focus,
  :where(.form-textarea-error):focus {
    box-shadow: 0 0 0 3px var(--color-error-light);
  }

  /* Success state */
  :where(.form-input-success),
  :where(.form-select-success),
  :where(.form-textarea-success) {
    border-color: var(--color-success);
  }

  /* Helper text */
  :where(.form-help) {
    font-size: var(--font-size-sm);
    color: var(--color-fg-secondary);
  }

  :where(.form-error) {
    font-size: var(--font-size-sm);
    color: var(--color-error);
    display: flex;
    align-items: center;
    gap: var(--space-1);
  }

  /* Checkbox & Radio */
  :where(.form-checkbox),
  :where(.form-radio) {
    width: var(--space-4);
    height: var(--space-4);
    accent-color: var(--color-brand-primary);
    cursor: pointer;
  }

  :where(.form-checkbox):disabled,
  :where(.form-radio):disabled {
    cursor: not-allowed;
    opacity: 0.5;
  }

  /* File input */
  :where(.form-file) {
    cursor: pointer;
  }

  :where(.form-file)::file-selector-button {
    padding: var(--space-2) var(--space-4);
    margin-right: var(--space-3);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-sm);
    background-color: var(--color-bg-tertiary);
    color: var(--color-fg-primary);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: background-color var(--duration-base) var(--ease-out);
  }

  :where(.form-file)::file-selector-button:hover {
    background-color: var(--color-bg-secondary);
  }

  /* ==========================================================================
     BADGES & TAGS
     ========================================================================== */

  :where(.badge) {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    padding: var(--space-1) var(--space-2);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
    line-height: var(--line-height-tight);
    border-radius: var(--radius-full);
    white-space: nowrap;
  }

  :where(.badge-primary) {
    background-color: var(--color-brand-light);
    color: var(--color-brand-primary);
  }

  :where(.badge-success) {
    background-color: var(--color-success-light);
    color: var(--color-success);
  }

  :where(.badge-warning) {
    background-color: var(--color-warning-light);
    color: var(--color-warning);
  }

  :where(.badge-error) {
    background-color: var(--color-error-light);
    color: var(--color-error);
  }

  :where(.badge-info) {
    background-color: var(--color-info-light);
    color: var(--color-info);
  }

  /* ==========================================================================
     ALERTS & NOTIFICATIONS
     ========================================================================== */

  :where(.alert) {
    display: flex;
    gap: var(--space-3);
    padding: var(--space-4);
    border-radius: var(--radius-md);
    border-left-width: 4px;
  }

  :where(.alert-info) {
    background-color: var(--color-info-light);
    border-color: var(--color-info);
    color: var(--color-info-contrast);
  }

  :where(.alert-success) {
    background-color: var(--color-success-light);
    border-color: var(--color-success);
    color: var(--color-success-contrast);
  }

  :where(.alert-warning) {
    background-color: var(--color-warning-light);
    border-color: var(--color-warning);
    color: var(--color-warning-contrast);
  }

  :where(.alert-error) {
    background-color: var(--color-error-light);
    border-color: var(--color-error);
    color: var(--color-error-contrast);
  }

  /* ==========================================================================
     NAVIGATION
     ========================================================================== */

  :where(.nav) {
    display: flex;
    gap: var(--space-2);
  }

  :where(.nav-link) {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2-5) var(--space-4);
    font-weight: var(--font-weight-medium);
    color: var(--color-fg-secondary);
    text-decoration: none;
    border-radius: var(--radius-md);
    transition: color var(--duration-base) var(--ease-out),
                background-color var(--duration-base) var(--ease-out);
  }

  :where(.nav-link):hover {
    color: var(--color-brand-primary);
    background-color: var(--color-brand-lighter);
  }

  :where(.nav-link-active) {
    color: var(--color-brand-primary);
    background-color: var(--color-brand-light);
    font-weight: var(--font-weight-semibold);
  }

  /* ==========================================================================
     MODAL & DIALOG
     ========================================================================== */

  :where(.modal-backdrop) {
    position: fixed;
    inset: 0;
    background-color: rgb(0 0 0 / 0.5);
    backdrop-filter: blur(var(--blur-sm));
    z-index: var(--z-modal-backdrop);

    /* Animation */
    animation: fade-in var(--duration-medium) var(--ease-out);
  }

  :where(.modal) {
    position: fixed;
    inset: 0;
    z-index: var(--z-modal);
    display: grid;
    place-items: center;
    padding: var(--space-4);
    overflow-y: auto;
  }

  :where(.modal-content) {
    background-color: var(--color-bg-primary);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-2xl);
    max-width: var(--container-md);
    width: 100%;

    /* Animation */
    animation: slide-up var(--duration-medium) var(--ease-out);
  }

  :where(.modal-header) {
    padding: var(--space-6);
    border-bottom: 1px solid var(--color-border-primary);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  :where(.modal-body) {
    padding: var(--space-6);
  }

  :where(.modal-footer) {
    padding: var(--space-6);
    border-top: 1px solid var(--color-border-primary);
    display: flex;
    gap: var(--space-3);
    justify-content: flex-end;
  }

  /* ==========================================================================
     LOADING & SKELETON
     ========================================================================== */

  :where(.spinner) {
    width: var(--space-8);
    height: var(--space-8);
    border: 3px solid var(--color-border-primary);
    border-top-color: var(--color-brand-primary);
    border-radius: var(--radius-full);
    animation: spin 800ms linear infinite;
  }

  :where(.skeleton) {
    background: linear-gradient(
      90deg,
      var(--color-bg-tertiary) 0%,
      var(--color-bg-secondary) 50%,
      var(--color-bg-tertiary) 100%
    );
    background-size: 200% 100%;
    border-radius: var(--radius-md);
    animation: skeleton-loading 1.5s ease-in-out infinite;
  }

  /* ==========================================================================
     ANIMATIONS
     ========================================================================== */

  @keyframes fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes slide-up {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  @keyframes skeleton-loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }
}
